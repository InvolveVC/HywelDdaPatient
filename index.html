<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SQOD Interactive Troubleshooting Guide</title>
<meta name="google" content="notranslate">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
:root{ --brand:#212529; --pink:#325083; --bg:#E8EDEE; --card:#fff; }
body{margin:0;background:var(--bg);font-family:'Poppins',sans-serif;color:var(--brand);display:flex;justify-content:center;padding:32px 0;}
.card{position:relative;width:65%;max-width:760px;min-height:70vh;background:#fff;border-radius:20px;padding:50px 32px 80px;box-shadow:0 10px 32px rgba(8,10,82,0.10);display:flex;align-items:center;}
.card.dynamic{min-height:auto;height:auto;padding:170px 40px 110px;align-items:flex-start;}
.content{max-width:740px;margin:0 auto;text-align:center;width:100%;}
.answer .content{text-align:left;font-size:1.12rem;line-height:1.72;max-width:660px;}
h1{font-size:1.74rem;margin:0 0 18px;font-weight:600;}
.btns{display:flex;justify-content:center;gap:16px;flex-wrap:wrap;margin-top:50px;}
.btn{background:var(--pink);color:#fff;border:none;padding:12px 18px;border-radius:10px;cursor:pointer;font-size:1rem;min-width:140px;}
.logo-top{position:absolute;top:20px;right:20px;max-width:290px;}
.logo-bottom{position:absolute;bottom:20px;left:20px;max-width:100px;opacity:0.9;}
.footer-icons{position:absolute;bottom:20px;right:20px;display:flex;gap:20px;}
.icon-btn{background:none;border:none;font-size:1.7rem;cursor:pointer;color:var(--brand);}
a{color:var(--pink);text-decoration:underline;}
.answer-text{max-width:660px;margin:0 auto;text-align:left;}
.note-small{color:var(--pink);font-style:italic;font-size:1.1rem;font-weight:400;display:block;margin-top:6px;}
.lang-switcher{position:absolute;top:20px;left:20px;display:flex;align-items:center;background:#fff;padding:4px;border-radius:999px;box-shadow:0 4px 12px rgba(8,10,82,0.08);font-size:0.85rem;z-index:5;gap:2px;}
.lang-pill{display:flex;align-items:center;gap:6px;border:none;background:transparent;cursor:pointer;font-family:'Poppins',sans-serif;font-size:0.85rem;padding:4px 10px;border-radius:999px;transition:background 0.15s ease,color 0.15s ease;}
.lang-pill .lang-code{font-weight:600;padding:2px 6px;border-radius:999px;background:#F3F4FD;}
.lang-pill.lang-active{background:var(--brand);color:#fff;}
.lang-pill.lang-active .lang-code{background:rgba(255,255,255,0.16);color:#fff;}
</style>
</head>
<body>
<div class="card" id="card">
  <div class="lang-switcher" role="radiogroup" aria-label="Language">
    <button class="lang-pill lang-active" id="lang-en" type="button" role="radio" aria-checked="true"><span class="lang-code">GB</span><span class="lang-name">English</span></button>
    <button class="lang-pill" id="lang-cy" type="button" role="radio" aria-checked="false"><span class="lang-code">CY</span><span class="lang-name">Cymraeg</span></button>
  </div>
 <img src="https://sqod.co.uk/wp-content/uploads/2023/12/Website-logo.png" class="logo-bottom" alt="Decorative">
  <img src="https://emedia1.nhs.wales/ABMUhb/cache/file/A4B0460A-8A03-4C92-BDC1B491FADE4FF4.jpg" class="logo-top" alt="SQOD Logo">
  <div class="content" id="content"></div>
  <div class="footer-icons">
    <button class="icon-btn" title="Back" onclick="goBack()">&#8592;</button>
    <button class="icon-btn" title="Restart" onclick="resetGuide()">&#8634;</button>
  </div>
</div>
<script>
let currentLang='en';
let history=[];
let current=null;
const startId="welcome";
const SLIDES={
"welcome":{type:"q",textEn:`Welcome to SQOD's interactive troubleshooting guide for Consultation Attendees experiencing issues joining a video consultation.<br><span class="note-small">Please click below to continue.</span>`,textCy:`Croeso i ganllaw datrys problemau rhyngweithiol SQOD ar gyfer mynychwyr ymgynghoriadau sy’n cael trafferth ymuno ag ymgynghoriad fideo.<br><span class="note-small">Cliciwch isod i barhau.</span>`,buttons:[{labelEn:"Continue",labelCy:"Parhau",next:"q1"}]},
"q1":{type:"q",textEn:`Are you using the correct secure waiting room or appointment link?`,textCy:`Ydych chi’n defnyddio’r ddolen ddiogel gywir i’r ystafell aros neu’r apwyntiad?`,buttons:[{labelEn:"Yes",labelCy:"Ie",next:"q2"},{labelEn:"Unsure",labelCy:"Ddim yn siŵr",next:"a1"}]},
"a1":{type:"a",textEn:`It looks like you may be trying to join using the wrong link.<br><br>Please return to your <b>appointment confirmation email or text message</b> and click the <b>secure consultation link</b> provided.<br><br>If you cannot locate this, please contact your consultation provider and request a new link be resent to you.`,textCy:`Mae’n edrych fel eich bod o bosibl yn ceisio ymuno drwy’r ddolen anghywir.<br><br>Ewch yn ôl at eich <b>e-bost neu neges destun cadarnhau apwyntiad</b> a chliciwch ar y <b>ddolen ymgynghori ddiogel</b> a ddarparwyd.<br><br>Os na allwch ddod o hyd iddi, cysylltwch â’ch darparwr ymgynghori a gofynnwch i ddolen newydd gael ei hanfon atoch.`,nextBtn:true,next:"q2"},
"q2":{type:"q",textEn:`Have you entered and confirmed your personal information?`,textCy:`Ydych chi wedi nodi a chadarnhau eich manylion personol?`,buttons:[{labelEn:"Yes",labelCy:"Ie",next:"q3"},{labelEn:"No",labelCy:"Na",next:"a2"}]},
"a2":{type:"a",textEn:`Once you've opened your invite link, you will enter the waiting room/appointment landing page, <b>signposted at the top of the page</b>.<br><br><b>Pressing continue</b> will bring you to the "Further Details" page, where you can enter any relevant personal information. You may need to scroll down to access the button, and any invalid fields will be highlighted in red.<br><br>You'll be given a final opportunity to review your personal information before joining the waiting room/your appointment via the highlighted button. Alternatively, you can change your answers via the "change your details" button directly beneath.`,textCy:`Unwaith y byddwch wedi agor eich dolen wahoddiad, byddwch yn cyrraedd tudalen lanio’r ystafell aros/yr apwyntiad, <b>wedi’i nodi ar frig y dudalen</b>.<br><br>Bydd <b>pwyso “Parhau”</b> yn mynd â chi i’r dudalen “Further Details”, lle gallwch nodi unrhyw fanylion personol perthnasol. Efallai bydd angen i chi sgrolio i lawr i gyrraedd y botwm, a bydd unrhyw feysydd annilys yn cael eu hamlygu mewn coch.<br><br>Cewch gyfle olaf i adolygu eich manylion cyn ymuno â’r ystafell aros/â’ch apwyntiad drwy’r botwm wedi’i amlygu. Fel arall, gallwch newid eich atebion drwy’r botwm “change your details” yn union oddi tano.`,nextBtn:true,next:"q3"},
"q3":{type:"q",textEn:`Have you entered the video consultation?`,textCy:`Ydych chi wedi mynd i mewn i’r ymgynghoriad fideo?`,buttons:[{labelEn:"Yes",labelCy:"Ie",next:"q4"},{labelEn:"No",labelCy:"Na",next:"a3"}]},
"a3":{type:"a",textEn:`After confirming your details, you will progress on to a page with a green square either confirming the time of your appointment or the name of the waiting area.<br><br>Once your provider has started the consultation, there will be a <b>short 15–20 second delay</b> before you enter the call.<br><br>If it is past the agreed start time and you are still on the waiting page, please contact your consultation provider directly.`,textCy:`Ar ôl cadarnhau eich manylion, byddwch yn symud ymlaen i dudalen gyda sgwâr gwyrdd sy’n cadarnhau naill ai amser eich apwyntiad neu enw’r ardal aros.<br><br>Unwaith y bydd eich darparwr wedi dechrau’r ymgynghoriad, bydd <b>oedi byr o 15–20 eiliad</b> cyn i chi fynd i mewn i’r alwad.<br><br>Os yw wedi mynd heibio’r amser cychwyn a gytunwyd ac rydych yn dal ar y dudalen aros, cysylltwch â’ch darparwr ymgynghori yn uniongyrchol.`,nextBtn:true,next:"q4"},
"q4":{type:"q",textEn:`Have you granted permission for camera and microphone access?`,textCy:`Ydych chi wedi caniatáu mynediad i’r camera a’r meicroffon?`,buttons:[{labelEn:"Yes",labelCy:"Ie",next:"q5"},{labelEn:"No",labelCy:"Na",next:"a4"}]},
"a4":{type:"a",textEn:`Your browser or device is currently blocking access to your camera or microphone.<br><br>To proceed, please enable <b>device permissions</b> within your browser:<br>– Look for the padlock or camera/microphone icon in your browser’s address bar.<br>– Select <b>‘Allow’</b> when prompted.<br>– <b>Refresh the page</b> and re-join the consultation.<br><br>If you are unsure how to change these settings, you can view our guide on how to do so, <a href="https://resources.sqod.co.uk/article/52-audio-or-video-device-issues" target="_blank" rel="noopener">here</a>.`,textCy:`Mae eich porwr neu’ch dyfais ar hyn o bryd yn rhwystro mynediad at eich camera neu’ch meicroffon.<br><br>I symud ymlaen, galluogwch <b>ganiatâd dyfais</b> yn eich porwr:<br>– Chwiliwch am eicon y clo neu eicon y camera/meicroffon yn y bar cyfeiriad.<br>– Dewiswch <b>“Caniatáu”</b> pan gewch ofyn.<br>– <b>Adnewyddwch y dudalen</b> ac ail-ymunwch â’r ymgynghoriad.<br><br>Os nad ydych yn siŵr sut i newid y gosodiadau hyn, gallwch weld ein canllaw ar sut i wneud hynny <a href="https://resources.sqod.co.uk/article/52-audio-or-video-device-issues" target="_blank" rel="noopener">yma</a>.`,nextBtn:true,next:"q5"},
"q5":{type:"q",textEn:`Are your video and microphone icons turned on (not muted)?`,textCy:`A yw eiconau’r fideo a’r meicroffon ymlaen (heb eu tawelu)?`,buttons:[{labelEn:"Yes",labelCy:"Ie",next:"q6"},{labelEn:"Unsure",labelCy:"Ddim yn siŵr",next:"a5"}]},
"a5":{type:"a",textEn:`Your microphone or camera may be turned off within the consultation window.<br><br>Please check the icons at the bottom of the screen. A <b>red or crossed-out symbol</b> indicates the feature is muted.<br><br><b>Click the icon</b> once to turn your microphone or camera back on. If the icon remains disabled, try leaving and re-joining the session.`,textCy:`Efallai bod eich meicroffon neu’ch camera wedi’i ddiffodd o fewn ffenestr yr ymgynghoriad.<br><br>Gwiriwch yr eiconau ar waelod y sgrin. Mae <b>symbol coch neu symbol wedi’i groesi allan</b> yn golygu bod y nodwedd wedi’i thawelu.<br><br><b>Cliciwch ar yr eicon</b> unwaith i droi’r meicroffon neu’r camera yn ôl ymlaen. Os yw’r eicon yn parhau’n anabl, rhowch gynnig ar adael ac ail-ymuno â’r sesiwn.`,nextBtn:true,next:"q6"},
"q6":{type:"q",textEn:`Are you using a supported browser that is up-to-date?<br><span class="note-small">SQOD supports Chrome or Chromium based browsers such as Google Chrome, Microsoft Edge, Safari, Firefox and Brave.</span>`,textCy:`Ydych chi’n defnyddio porwr a gefnogir sydd wedi’i ddiweddaru?<br><span class="note-small">Mae SQOD yn cefnogi porwyr Chrome neu borwyr sy’n seiliedig ar Chromium fel Google Chrome, Microsoft Edge, Safari, Firefox a Brave.</span>`,buttons:[{labelEn:"Yes",labelCy:"Ie",next:"q7"},{labelEn:"No",labelCy:"Na",next:"a6"}]},
"a6":{type:"a",textEn:`An outdated or unsupported browser/app may prevent your consultation from starting.<br><br>Please <b>update to the latest version</b> of a supported browser (Google Chrome, Microsoft Edge, or Safari). Alternatively, try joining your consultation on a different device.<br><br>If you are using a <b>mobile device</b>, ensure your operating system and app are fully updated. After updating, restart your device and re-join the consultation.`,textCy:`Gall porwr/ap hen neu heb ei gefnogi atal eich ymgynghoriad rhag dechrau.<br><br><b>Diweddarwch i’r fersiwn ddiweddaraf</b> o borwr a gefnogir (Google Chrome, Microsoft Edge, neu Safari). Fel arall, rhowch gynnig ar ymuno â’ch ymgynghoriad ar ddyfais arall.<br><br>Os ydych yn defnyddio <b>dyfais symudol</b>, gwnewch yn siŵr bod eich system weithredu a’ch apiau wedi’u diweddaru’n llawn. Ar ôl diweddaru, ailgychwynnwch eich dyfais ac ail-ymunwch â’r ymgynghoriad.`,nextBtn:true,next:"q7"},
"q7":{type:"q",textEn:`Have you tried refreshing the page and reopening the invite link in incognito/a private browsing tab?`,textCy:`Ydych chi wedi ceisio adnewyddu’r dudalen ac ailagor y ddolen wahoddiad mewn tab anhysbys/mewn pori preifat?`,buttons:[{labelEn:"Yes",labelCy:"Ie",next:"q8"},{labelEn:"No",labelCy:"Na",next:"a7"}]},
"a7":{type:"a",textEn:`Please refresh your browser and attempt to re-join the consultation.<br><br>If the issue continues, try opening the consultation link in an <b>incognito or private browsing window</b>. This disables extensions and cached settings that may interfere with video calls.<br><br>We have a step-by-step guide on how to do this <a href="https://resources.sqod.co.uk/article/54-clearing-your-cache" target="_blank" rel="noopener">here</a>.`,textCy:`Adnewyddwch eich porwr a rhowch gynnig ar ail-ymuno â’r ymgynghoriad.<br><br>Os yw’r broblem yn parhau, rhowch gynnig ar agor y ddolen ymgynghori mewn <b>ffenestr anhysbys neu borwr preifat</b>. Mae hyn yn analluogi estyniadau a gosodiadau wedi’u storio (cache) a all ymyrryd â galwadau fideo.<br><br>Mae gennym ganllaw cam-wrth-gam ar sut i wneud hyn <a href="https://resources.sqod.co.uk/article/54-clearing-your-cache" target="_blank" rel="noopener">yma</a>.`,nextBtn:true,next:"q8"},
"q8":{type:"q",textEn:`Have you cleared your cache (browser history)?`,textCy:`Ydych chi wedi clirio’r storfa (cache) a’r hanes pori?`,buttons:[{labelEn:"Yes",labelCy:"Ie",next:"q9"},{labelEn:"No",labelCy:"Na",next:"a8"}]},
"a8":{type:"a",textEn:`Clearing your browser’s cache and cookies often resolves loading and login issues by removing outdated data.<br><br>To clear cache:<br>1. Open your browser settings (usually found under ‘History’ or ‘Privacy’).<br>2. Select <b>Clear browsing data</b>.<br>3. Choose to clear Cache and Cookies.<br>4. Close and reopen your browser.<br>5. Return to your consultation link and try again.<br><br>For detailed instructions, we have a step-by-step guide on how to do this <a href="https://resources.sqod.co.uk/article/54-clearing-your-cache" target="_blank" rel="noopener">here</a>.`,textCy:`Mae clirio storfa (cache) a chwcis eich porwr yn aml yn datrys problemau llwytho neu fewngofnodi drwy ddileu data hen.<br><br>I glirio’r storfa:<br>1. Agorwch osodiadau eich porwr (fel arfer o dan “History” neu “Privacy”).<br>2. Dewiswch <b>Clear browsing data</b>.<br>3. Dewiswch glirio Cache a Cookies.<br>4. Caewch ac ailagorwch eich porwr.<br>5. Dychwelwch at eich dolen ymgynghori a rhowch gynnig eto.<br><br>I gael cyfarwyddiadau manylach, mae gennym ganllaw cam-wrth-gam ar sut i wneud hyn <a href="https://resources.sqod.co.uk/article/54-clearing-your-cache" target="_blank" rel="noopener">yma</a>.`,nextBtn:true,next:"q9"},
"q9":{type:"q",textEn:`Are you on a stable internet connection? (e.g., wired or strong Wi-Fi)`,textCy:`Ydych chi ar gysylltiad rhyngrwyd sefydlog? (e.e. cysylltiad gwifredig neu Wi-Fi cryf)`,buttons:[{labelEn:"Yes",labelCy:"Ie",next:"q10"},{labelEn:"No",labelCy:"Na",next:"a9"}]},
"a9":{type:"a",textEn:`A weak or unstable internet connection can interrupt your consultation. Please try the following to boost your connectivity:<br><br>– Move closer to your Wi-Fi router or connect with a network cable if possible.<br>– Disconnect other devices from the network temporarily.<br>– If you are using mobile data, ensure you have a strong signal. You may need to move location to improve signal, or switch to Wi-Fi.<br><br>For the best experience, a minimum of <b>2 Mbps</b> upload and download speed is recommended. You can test your internet speed for free at <a href="https://speedtest.net" target="_blank" rel="noopener">speedtest.net</a>.`,textCy:`Gall cysylltiad rhyngrwyd gwan neu ansefydlog darfu ar eich ymgynghoriad. Rhowch gynnig ar y canlynol i wella eich cysylltedd:<br><br>– Symudwch yn nes at eich llwybrydd Wi-Fi, neu cysylltwch â chebl rhwydwaith os yn bosibl.<br>– Datgysylltwch ddyfeisiau eraill o’r rhwydwaith dros dro.<br>– Os ydych yn defnyddio data symudol, gwnewch yn siŵr bod gennych signal cryf. Efallai bydd angen symud lleoliad i gael signal gwell, neu newid i Wi-Fi.<br><br>Er mwyn cael y profiad gorau, argymhellir o leiaf <b>2 Mbps</b> ar gyfer cyflymder llwytho i fyny ac i lawr. Gallwch brofi eich cyflymder am ddim yn <a href="https://speedtest.net" target="_blank" rel="noopener">speedtest.net</a>.`,nextBtn:true,next:"q10"},
"q10":{type:"q",textEn:`Do you have other tabs or applications open?`,textCy:`Oes gennych dabiau neu raglenni eraill ar agor?`,buttons:[{labelEn:"No",labelCy:"Na",next:"q11"},{labelEn:"Yes",labelCy:"Oes",next:"a10"}]},
"a10":{type:"a",textEn:`Other apps or browser tabs may be using up your internet connection, camera, microphone, or system memory, which can slow down or interrupt your video consultation.<br><br>Please <b>close any unnecessary tabs</b>, especially those running video, music, or large downloads (e.g., YouTube, Netflix, Teams, Zoom, or file-sharing sites).<br><br>Also, close other applications that may be using your camera or microphone, such as Skype or FaceTime.<br><br>By freeing up resources, your device can give priority to your video consultation, resulting in a clearer picture and better sound quality.`,textCy:`Gall apiau eraill neu dabiau porwr fod yn defnyddio eich cysylltiad rhyngrwyd, camera, meicroffon neu gof y system, a gall hynny arafu neu darfu ar eich ymgynghoriad fideo.<br><br><b>Caewch unrhyw dabiau diangen</b>, yn enwedig y rhai sy’n chwarae fideo, cerddoriaeth neu lawrlwythiadau mawr (e.e. YouTube, Netflix, Teams, Zoom, neu safleoedd rhannu ffeiliau).<br><br>Hefyd, caewch raglenni eraill a allai fod yn defnyddio eich camera neu’ch meicroffon, megis Skype neu FaceTime.<br><br>Drwy ryddhau adnoddau, gall eich dyfais flaenoriaethu’r ymgynghoriad fideo, gan arwain at ddelwedd gliriach ac ansawdd sain gwell.`,nextBtn:true,next:"q11"},
"q11":{type:"q",textEn:`Can your device play other video content (YouTube, etc.)?`,textCy:`A all eich dyfais chwarae cynnwys fideo arall (YouTube ac ati)?`,buttons:[{labelEn:"Yes",labelCy:"Ie",next:"final"},{labelEn:"No",labelCy:"Na",next:"a11"}]},
"a11":{type:"a",textEn:`If your device cannot play standard video content, the issue is likely with your local video playback setup rather than the consultation platform.<br><br>– Test your camera and audio in another app (Zoom, Teams, Skype, FaceTime).<br>– Update your video and audio drivers (for computers).<br>– Restart your device and try again.<br><br><b>If video playback still fails</b>, please switch to another device.`,textCy:`Os na all eich dyfais chwarae cynnwys fideo safonol, mae’n debygol bod y broblem gyda’ch gosodiad chwarae fideo lleol yn hytrach na’r platfform ymgynghori.<br><br>– Profwch eich camera a’ch sain mewn ap arall (Zoom, Teams, Skype, FaceTime).<br>– Diweddarwch eich gyrwyr fideo a sain (ar gyfrifiaduron).<br>– Ailgychwynnwch eich dyfais a rhowch gynnig eto.<br><br><b>Os yw chwarae fideo’n dal i fethu</b>, newidiwch i ddyfais arall.`,nextBtn:true,next:"final"},
"final":{type:"a",textEn:`<div style="color:var(--pink);font-weight:600;font-size:1.3rem;text-align:center;margin:8px 0 10px;">Still having issues?</div>If you’re still experiencing problems after following the previous steps, please try the suggestions below before contacting your consultation provider:<br><br>– <b>Try an alternative device:</b> switch to a tablet/phone or vice versa.<br>– <b>Use a different browser:</b> try the latest Chrome, Edge or Safari.<br>– <b>Check your internet connection:</b> run a speed test (e.g. <a href="https://speedtest.net" target="_blank" rel="noopener">speedtest.net</a>) and ensure at least 2 Mbps up/down.<br>– <b>Review security software and settings:</b> VPN/antivirus/firewall may block video/audio; disable temporarily where possible.`,textCy:`<div style="color:var(--pink);font-weight:600;font-size:1.3rem;text-align:center;margin:8px 0 10px;">Dal yn cael problemau?</div>Os ydych yn dal i brofi problemau ar ôl dilyn y camau blaenorol, rhowch gynnig ar yr awgrymiadau isod cyn cysylltu â’ch darparwr ymgynghori yn Hywel Dda:<br><br>– <b>Rhowch gynnig ar ddyfais arall:</b> newidiwch i dabled/ffôn neu i’r gwrthwyneb.<br>– <b>Defnyddiwch borwr gwahanol:</b> rhowch gynnig ar y fersiynau diweddaraf o Chrome, Edge neu Safari.<br>– <b>Gwiriwch eich cysylltiad rhyngrwyd:</b> rhedwch brawf cyflym (e.e. <a href="https://speedtest.net" target="_blank" rel="noopener">speedtest.net</a>) a sicrhewch o leiaf 2 Mbps i fyny/i lawr.<br>– <b>Adolygwch feddalwedd a gosodiadau diogelwch:</b> gall VPN/gwrthfeirws/mur gwarchod rwystro fideo/sain; analluogwch dros dro lle bo modd.`,final:true}
};
function stripOuterQuotes(s){
  if(!s)return s;
  const t=s.trim();
  if((t.startsWith('"')&&t.endsWith('"'))||(t.startsWith('“')&&t.endsWith('”')))return t.slice(1,-1);
  return s;
}
function formatText(raw){
  let t=raw||"";
  t=stripOuterQuotes(t);
  t=t.replace(/\n/g,"<br>");
  return t;
}
function renderSlide(id){
  current=id;
  const slide=SLIDES[id];
  const content=document.getElementById("content");
  const card=document.getElementById("card");
  if(!slide){content.innerHTML="<div style='text-align:left'>Slide not found: "+id+"</div>";return;}
  card.className="card";
  if(slide.type==="q"){card.classList.add("question");}
  else{card.classList.add("answer","dynamic");}
  const textRaw=currentLang==='cy'?(slide.textCy||slide.textEn||""):(slide.textEn||slide.textCy||"");
  if(slide.type==="q"){
    const qtext=formatText(textRaw||"");
    const btns=(slide.buttons||[]).map(b=>{
      const label=currentLang==='cy'?(b.labelCy||b.labelEn||b.label):(b.labelEn||b.labelCy||b.label);
      return `<button class="btn" onclick="goTo('${b.next}')">${label}</button>`;
    }).join("");
    content.innerHTML=`<h1>${qtext}</h1><div class="btns">${btns}</div>`;
  }else{
    const html=formatText(textRaw||"");
    if(slide.final){
      content.innerHTML=`<div class="answer-text">${html}</div>`;
    }else if(slide.nextBtn){
      const next=currentLang==='cy'?"Nesaf":"Next";
      content.innerHTML=`<div class="answer-text">${html}<div class="btns"><button class="btn" onclick="goTo('${slide.next}')">${next}</button></div></div>`;
    }else{
      content.innerHTML=`<div class="answer-text">${html}</div>`;
    }
  }
}
function goTo(id){history.push(current);renderSlide(id);}
function goBack(){if(history.length){renderSlide(history.pop());}}
function resetGuide(){history=[];renderSlide(startId);}
function updateLangUI(){
  const enBtn=document.getElementById('lang-en');
  const cyBtn=document.getElementById('lang-cy');
  if(currentLang==='cy'){
    enBtn.classList.remove('lang-active');enBtn.setAttribute('aria-checked','false');
    cyBtn.classList.add('lang-active');cyBtn.setAttribute('aria-checked','true');
  }else{
    cyBtn.classList.remove('lang-active');cyBtn.setAttribute('aria-checked','false');
    enBtn.classList.add('lang-active');enBtn.setAttribute('aria-checked','true');
  }
  document.documentElement.lang=currentLang;
}
document.getElementById('lang-en').addEventListener('click',()=>{if(currentLang==='en')return;currentLang='en';updateLangUI();renderSlide(current||startId);});
document.getElementById('lang-cy').addEventListener('click',()=>{if(currentLang==='cy')return;currentLang='cy';updateLangUI();renderSlide(current||startId);});
updateLangUI();
renderSlide(startId);
</script>
</body>
</html>
